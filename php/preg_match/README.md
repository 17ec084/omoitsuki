# preg_replaceで参照するカッコに割り当てられる順番

## 実験説明

preg_replaceでは、第一引数$pattern内で括弧で括った正規表現にマッチする文字列を、第二引数$replace内で抽出することができる。  
抽出時には$1、$2のように、「$＋自然数による番号」を記述する。  
ではこの番号の割り振られる順番はいかがだろうか。  
「左から右の順」ということは有名だが、かっこがネストになっていた場合、「外から内の順」なのかあるいは逆なのかという問題が生じる。  
結論から言うと「外から内の順」であるという説明はネットでも発見できる。  
しかし、「外から内の順」というルールと「左から右の順」というルールではどちらの優先順位が高いのか、これは調べても見つからなかった。  
そこで、実験してみる。

## 実験

1. [こちら](test.php) のファイルを実行する  

以上

## 考察

### 理論

今回2回実験を行った。  
「外内 ＞ 左右と考える場合」の実験では、  
"12423531"という文字列を、  
パターン"/(1(2(4)2)(3(5)3)1)/"にマッチさせた。  
もしも、外内 ＞ 左右が正しいのなら、  
$1は、もっとも外側かつ左側の括弧で括られた12423531となるだろう。  
これ以上右がないため、一つ内側へ入る。  
$2は、2番目に外側でもっとも左側の括弧で括られた242となるだろう。  
$3は、2番目に外側で、2番目に左側の括弧で括られた353となるだろう。  
これ以上右がないため、一つ内側へ入る。  
$4は、3番目に外側で、もっとも左側の括弧で括られた4となるだろう。  
$5は、3番目に外側で、2番目に左側の括弧で括られた5となるだろう。  
  
「左右 ＞ 外内と考える場合」の実験では、  
"12324541"という文字列を、  
パターン"/(1(2(3)2)(4(5)4)1)/"にマッチさせた。  
もしも、左右 ＞ 外内が正しいのなら、  
$1は、もっとも左側かつ外側の括弧で括られた12324541となるだろう。  
$2は、もっとも左側で2番目に外側の括弧で括られた232となるだろう。  
$3は、もっとも左側で、3番目に外側の括弧で括られた3となるだろう。  
これ以上内側に入れないため、一つ右側へいく。  
$4は、2番目に左側で、もっとも外側の括弧で括られた454となるだろう。  
$5は、2番目に左側で、2番目に外側の括弧で括られた5となるだろう。  

### 結果
後者だった。  
(少なくとも000.webhostapp.comが2019年4月24日時点でデフォルトで提供しているphpのバージョンおよび設定では)

